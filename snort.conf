###############################################################################
# Snort Configuration File
# Purpose: Custom configuration for detecting port scans, malware traffic, and DoS attacks.
###############################################################################

# VARIABLES
# Define network variables
ipvar HOME_NET 192.168.1.0/24      # Your network range
ipvar EXTERNAL_NET any             # External networks
portvar HTTP_PORTS 80              # HTTP traffic
portvar SHELLCODE_PORTS !80        # Non-HTTP traffic for shellcode detection

###############################################################################
# PREPROCESSORS
###############################################################################

# Enable packet normalization and anomaly detection
preprocessor frag3_global: max_frags 65536
preprocessor frag3_engine: policy linux detect_anomalies

# Enable HTTP traffic inspection
preprocessor http_inspect: global iis_unicode_map unicode.map 1252
preprocessor http_inspect_server: server default profile all ports { 80 } oversize_dir_length 500

# Enable detection for port scans
preprocessor sfportscan: proto { all } memcap 1000000 sense_level low

###############################################################################
# OUTPUT PLUGINS
###############################################################################

# Log alerts to a file in unified2 format (requires tools like Barnyard2 to parse)
output unified2: filename snort.log, limit 128

# Log alerts in console output
output alert_fast: stdout

###############################################################################
# RULES
###############################################################################

# Include custom rules from a separate file
include $RULE_PATH/custom.rules

###############################################################################
# TUNING
###############################################################################

# Performance tuning
config detection: search-method ac-split
config event_queue: max_events 8 log 3 order_events content_length

# Memory management
config flowbits_size: 64
